(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[156],{438:(e,s,t)=>{Promise.resolve().then(t.bind(t,5986))},5986:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>D});var r=t(5155),i=t(2115),n=t(6132),l=t(9559),a=t(5626),c=t(906),o=t(2619),d=t.n(o),m=t(1894);let x=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e3,[s,t]=(0,i.useState)(null),[r,n]=(0,i.useState)(!0),[l,a]=(0,i.useState)(null),c=(0,i.useRef)(null),o=(0,i.useCallback)(async()=>{try{let e=await m.FH.getTrainingProgress();t(e),a(null)}catch(e){a(e instanceof Error?e.message:"Failed to fetch training progress"),console.error("Training progress fetch error:",e)}finally{n(!1)}},[]),d=(0,i.useCallback)(()=>{c.current&&clearInterval(c.current),o(),c.current=setInterval(()=>{o()},e)},[o,e]),x=(0,i.useCallback)(()=>{c.current&&(clearInterval(c.current),c.current=null)},[]);return(0,i.useEffect)(()=>(d(),()=>x()),[d,x]),(0,i.useEffect)(()=>{s&&!s.is_running&&setTimeout(()=>{s&&!s.is_running&&x()},1e4)},[s,x]),{trainingState:s,isLoading:r,error:l,stopTraining:(0,i.useCallback)(async()=>{try{await m.FH.stopTraining(),setTimeout(o,1e3)}catch(e){a(e instanceof Error?e.message:"Failed to stop training")}},[o]),refresh:o,startPolling:d,stopPolling:x}},u=(0,t(1847).A)("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);var h=t(1524);let g=e=>{let{trainingState:s,onStop:t}=e,l=(0,i.useMemo)(()=>Math.round(s.current_epoch/s.total_epochs*100),[s.current_epoch,s.total_epochs]);return(0,r.jsxs)("div",{className:"rounded-lg border border-gray-200 bg-white shadow-sm",children:[(0,r.jsx)("div",{className:"flex flex-col space-y-1.5 p-6 pb-3",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h3",{className:"text-2xl font-semibold leading-none tracking-tight",children:"Training Status"}),(0,r.jsx)("span",{className:"inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold ".concat(s.is_running?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"),children:s.is_running?"Running":"Stopped"})]})}),(0,r.jsxs)("div",{className:"p-6 pt-0 space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm mb-2 font-medium",children:[(0,r.jsxs)("span",{children:["Epoch ",s.current_epoch," / ",s.total_epochs]}),(0,r.jsxs)("span",{children:[l,"%"]})]}),(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:(0,r.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(l,"%")}})})]}),(0,r.jsxs)("div",{className:"flex justify-between text-sm text-gray-600",children:[(0,r.jsx)("span",{children:"Duration"}),(0,r.jsx)("span",{className:"font-medium",children:(e=>{if(!e)return"Unknown";let s=new Date(e),t=new Date().getTime()-s.getTime(),r=Math.floor(t/6e4),i=Math.floor(t%6e4/1e3);return r>0?"".concat(r,"m ").concat(i,"s"):"".concat(i,"s")})(s.started_at)})]}),(0,r.jsx)("div",{className:"pt-2 flex gap-2",children:s.is_running?(0,r.jsxs)("button",{onClick:t,className:"w-full inline-flex items-center justify-center rounded-md text-sm font-medium bg-red-600 text-white hover:bg-red-700 h-9 px-3 transition-colors focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2",children:[(0,r.jsx)(u,{className:"mr-2 h-4 w-4"}),"Stop Training"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(d(),{href:"/results",className:"flex-1 inline-flex items-center justify-center rounded-md text-sm font-medium bg-blue-600 text-white hover:bg-blue-700 h-9 px-3 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:[(0,r.jsx)(h.A,{className:"mr-2 h-4 w-4"}),"View Results"]}),(0,r.jsx)(d(),{href:"/training/configure",className:"flex-1 inline-flex items-center justify-center rounded-md text-sm font-medium border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 h-9 px-3 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"New Training"})]})}),s.error_message&&(0,r.jsx)("div",{className:"mt-2 rounded-lg border border-red-200 bg-red-50 p-4",children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)(n.A,{className:"h-4 w-4 text-red-600 mt-0.5 flex-shrink-0"}),(0,r.jsx)("p",{className:"text-xs text-red-800",children:s.error_message})]})})]})]})},f=e=>{let{latestMetrics:s}=e;return(0,r.jsxs)("div",{className:"rounded-lg border border-gray-200 bg-white shadow-sm",children:[(0,r.jsxs)("div",{className:"flex flex-col space-y-1.5 p-6 pb-3",children:[(0,r.jsx)("h3",{className:"text-2xl font-semibold leading-none tracking-tight",children:"Current Metrics"}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:s&&"Epoch ".concat(s.epoch)})]}),(0,r.jsx)("div",{className:"p-6 pt-0",children:s?(0,r.jsxs)("div",{className:"grid grid-cols-4 gap-3",children:[(0,r.jsx)(b,{label:"Loss",value:s.loss,color:"text-red-600",decimals:3}),(0,r.jsx)(b,{label:"ARI",value:s.ari,color:"text-green-600",decimals:3}),(0,r.jsx)(b,{label:"NMI",value:s.nmi,color:"text-blue-600",decimals:3}),(0,r.jsx)(b,{label:"ASW",value:s.asw,color:"text-purple-600",decimals:3}),(0,r.jsx)(b,{label:"CH",value:s.ch,color:"text-orange-600",decimals:1,size:"sm"}),(0,r.jsx)(b,{label:"DB",value:s.db,color:"text-red-500",decimals:3,size:"sm"}),(0,r.jsx)(b,{label:"PC",value:s.pc,color:"text-green-500",decimals:3,size:"sm"}),(0,r.jsx)("div",{className:"text-center flex items-center justify-center",children:(0,r.jsx)("span",{className:"inline-flex items-center rounded-md border border-gray-300 bg-white px-2.5 py-0.5 text-xs font-semibold text-gray-700",children:"Live"})})]}):(0,r.jsx)("p",{className:"text-gray-500 text-sm",children:"No metrics available yet"})})]})},b=e=>{let{label:s,value:t,color:i,decimals:n,size:l="lg"}=e;return(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-xs text-gray-600 mb-1",children:s}),(0,r.jsx)("div",{className:"".concat("lg"===l?"text-lg":"text-sm"," font-bold ").concat(i),children:t.toFixed(n)})]})};var p=t(6991),j=t(5216),y=t(8425),v=t(7734),N=t(3697),w=t(7033),k=t(813),C=t(6119);let _={loss:{color:"#dc2626",label:"Loss",betterDirection:"down"},ari:{color:"#16a34a",label:"ARI",betterDirection:"up"},nmi:{color:"#2563eb",label:"NMI",betterDirection:"up"},asw:{color:"#7c3aed",label:"ASW",betterDirection:"up"},ch:{color:"#ea580c",label:"CH",betterDirection:"up"},db:{color:"#dc2626",label:"DB",betterDirection:"down"},pc:{color:"#059669",label:"PC",betterDirection:"up"}},A=e=>{let{data:s,metrics:t,height:i=300}=e;return(0,r.jsx)("div",{style:{height:i},children:(0,r.jsx)(p.u,{width:"100%",height:"100%",children:(0,r.jsxs)(j.b,{data:s,margin:{top:5,right:30,left:20,bottom:5},children:[(0,r.jsx)(y.d,{strokeDasharray:"3 3",opacity:.2}),(0,r.jsx)(v.W,{dataKey:"epoch",tick:{fontSize:12},label:{value:"Epoch",position:"insideBottom",offset:-5}}),(0,r.jsx)(N.h,{tick:{fontSize:12}}),(0,r.jsx)(w.m,{contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"6px"},formatter:e=>e.toFixed(4)}),(0,r.jsx)(k.s,{}),t.map(e=>(0,r.jsx)(C.N,{type:"monotone",dataKey:e,name:_[e].label,stroke:_[e].color,strokeWidth:2,dot:!1,activeDot:{r:4}},e))]})})})},M=e=>{let{chartData:s}=e,[t,n]=(0,i.useState)("primary");return(0,r.jsxs)("div",{className:"rounded-lg border border-gray-200 bg-white shadow-sm",children:[(0,r.jsxs)("div",{className:"flex flex-col space-y-1.5 p-6",children:[(0,r.jsx)("h3",{className:"text-2xl font-semibold leading-none tracking-tight",children:"Metrics Visualization"}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Training progress across all evaluation metrics"})]}),(0,r.jsx)("div",{className:"p-6 pt-0",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"inline-flex h-10 items-center justify-center rounded-md bg-gray-100 p-1 text-gray-500 w-full",children:[(0,r.jsx)("button",{onClick:()=>n("primary"),className:"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-white transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 flex-1 ".concat("primary"===t?"bg-white text-gray-900 shadow-sm":"hover:bg-gray-200/50"),children:"Primary Metrics"}),(0,r.jsx)("button",{onClick:()=>n("clustering"),className:"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-white transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 flex-1 ".concat("clustering"===t?"bg-white text-gray-900 shadow-sm":"hover:bg-gray-200/50"),children:"Clustering Quality"}),(0,r.jsx)("button",{onClick:()=>n("all"),className:"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-white transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 flex-1 ".concat("all"===t?"bg-white text-gray-900 shadow-sm":"hover:bg-gray-200/50"),children:"All Metrics"})]}),"primary"===t&&(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium mb-2 text-gray-700",children:"Training Loss"}),(0,r.jsx)(A,{data:s,metrics:["loss"],height:250})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium mb-2 text-gray-700",children:"Clustering Accuracy (ARI)"}),(0,r.jsx)(A,{data:s,metrics:["ari"],height:250})]})]})}),"clustering"===t&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium mb-2 text-gray-700",children:"Quality Metrics Comparison"}),(0,r.jsx)(A,{data:s,metrics:["ari","nmi","asw","pc"],height:350})]}),(0,r.jsxs)("div",{className:"grid md:grid-cols-3 gap-4 text-xs",children:[(0,r.jsxs)("div",{className:"bg-green-50 p-3 rounded",children:[(0,r.jsx)("strong",{children:"ARI:"})," Clustering accuracy vs ground truth"]}),(0,r.jsxs)("div",{className:"bg-blue-50 p-3 rounded",children:[(0,r.jsx)("strong",{children:"NMI:"})," Mutual information measure"]}),(0,r.jsxs)("div",{className:"bg-purple-50 p-3 rounded",children:[(0,r.jsx)("strong",{children:"ASW:"})," Cluster separation quality"]})]})]}),"all"===t&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium mb-2 text-gray-700",children:"Loss & Accuracy"}),(0,r.jsx)(A,{data:s,metrics:["loss","ari"],height:250})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium mb-2 text-gray-700",children:"Separation Metrics"}),(0,r.jsx)(A,{data:s,metrics:["asw","ch","db"],height:250})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium mb-2 text-gray-700",children:"Information & Connectivity"}),(0,r.jsx)(A,{data:s,metrics:["nmi","pc"],height:250})]})]})]})})]})},S=()=>{let{trainingState:e,isLoading:s,error:t,stopTraining:o,refresh:m}=x(),u=(0,i.useMemo)(()=>(null==e?void 0:e.history)?e.history.map(e=>({epoch:e.epoch,loss:e.loss,ari:e.ari,nmi:e.nmi,asw:e.asw,ch:e.ch,db:e.db,pc:e.pc})):[],[null==e?void 0:e.history]);return s&&!e?(0,r.jsx)("div",{className:"container mx-auto py-8 px-4 max-w-6xl",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),(0,r.jsx)("p",{children:"Loading training status..."})]})}):t&&!e?(0,r.jsxs)("div",{className:"container mx-auto py-8 px-4 max-w-4xl",children:[(0,r.jsx)("div",{className:"rounded-lg border border-red-200 bg-red-50 p-4",children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)(n.A,{className:"h-5 w-5 text-red-600 mt-0.5 flex-shrink-0"}),(0,r.jsx)("p",{className:"text-sm text-red-800",children:t})]})}),(0,r.jsxs)("div",{className:"mt-4 flex gap-4",children:[(0,r.jsxs)("button",{onClick:m,className:"inline-flex items-center justify-center rounded-md text-sm font-medium bg-blue-600 text-white hover:bg-blue-700 h-10 px-4 py-2 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:[(0,r.jsx)(l.A,{className:"mr-2 h-4 w-4"}),"Retry"]}),(0,r.jsx)(d(),{href:"/",className:"inline-flex items-center justify-center rounded-md text-sm font-medium border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 h-10 px-4 py-2 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Back to Home"})]})]}):e?(0,r.jsxs)("div",{className:"container mx-auto py-8 px-4 max-w-7xl",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h1",{className:"text-3xl font-bold flex items-center gap-3",children:[(0,r.jsx)(c.A,{className:"h-8 w-8"}),"Training Monitor"]}),(0,r.jsx)("p",{className:"text-gray-600 mt-1",children:"Real-time progress tracking with 10-epoch smoothed metrics"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{onClick:m,title:"Refresh",className:"inline-flex items-center justify-center rounded-md text-sm font-medium border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 h-9 px-3 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:(0,r.jsx)(l.A,{className:"h-4 w-4"})}),(0,r.jsxs)(d(),{href:"/",className:"inline-flex items-center justify-center rounded-md text-sm font-medium border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 h-9 px-4 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:[(0,r.jsx)(a.A,{className:"mr-2 h-4 w-4"}),"Home"]})]})]}),(0,r.jsxs)("div",{className:"grid md:grid-cols-2 gap-6 mb-8",children:[(0,r.jsx)(g,{trainingState:e,onStop:o}),(0,r.jsx)(f,{latestMetrics:e.latest_metrics})]}),u.length>0&&(0,r.jsx)(M,{chartData:u})]}):(0,r.jsxs)("div",{className:"container mx-auto py-8 px-4 max-w-4xl",children:[(0,r.jsx)("div",{className:"rounded-lg border border-blue-200 bg-blue-50 p-4",children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)(n.A,{className:"h-5 w-5 text-blue-600 mt-0.5 flex-shrink-0"}),(0,r.jsx)("p",{className:"text-sm text-blue-800",children:"No training session found. Please configure and start training first."})]})}),(0,r.jsxs)("div",{className:"mt-4 flex gap-4",children:[(0,r.jsx)(d(),{href:"/training/configure",className:"inline-flex items-center justify-center rounded-md text-sm font-medium bg-blue-600 text-white hover:bg-blue-700 h-10 px-4 py-2 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Configure Training"}),(0,r.jsxs)(d(),{href:"/",className:"inline-flex items-center justify-center rounded-md text-sm font-medium border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 h-10 px-4 py-2 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:[(0,r.jsx)(a.A,{className:"mr-2 h-4 w-4"}),"Back to Home"]})]})]})};function D(){return(0,r.jsx)(S,{})}}},e=>{e.O(0,[223,697,255,358],()=>e(e.s=438)),_N_E=e.O()}]);