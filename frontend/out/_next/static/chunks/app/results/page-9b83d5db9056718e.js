(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[139],{1780:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>$});var t=a(5155),l=a(2115),r=a(2619),n=a.n(r),i=a(1847);let d=(0,i.A)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var c=a(9559),o=a(5626),x=a(1983),m=a(5849),h=a(7389);let j=e=>{var{variant:s="default",size:a="md",className:l="",disabled:r,children:n}=e,i=(0,h._)(e,["variant","size","className","disabled","children"]);return(0,t.jsx)("button",(0,m._)((0,x._)({className:"".concat("inline-flex items-center justify-center rounded-md font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none"," ").concat({default:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",outline:"border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 focus:ring-blue-500",destructive:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",secondary:"bg-gray-200 text-gray-900 hover:bg-gray-300 focus:ring-gray-500"}[s]," ").concat({sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"}[a]," ").concat(l),disabled:r},i),{children:n}))},g=e=>{let{variant:s="default",children:a,className:l=""}=e;return(0,t.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat({default:"bg-blue-600 text-white",secondary:"bg-gray-200 text-gray-900",outline:"border border-gray-300 bg-white text-gray-700",destructive:"bg-red-600 text-white"}[s]," ").concat(l),children:a})},u=e=>{let{children:s,className:a=""}=e;return(0,t.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm ".concat(a),children:s})},p=e=>{let{children:s,className:a=""}=e;return(0,t.jsx)("div",{className:"px-6 py-5 border-b border-gray-200 ".concat(a),children:s})},b=e=>{let{children:s,className:a=""}=e;return(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 ".concat(a),children:s})},N=e=>{let{children:s,className:a=""}=e;return(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-1 ".concat(a),children:s})},v=e=>{let{children:s,className:a=""}=e;return(0,t.jsx)("div",{className:"px-6 py-5 ".concat(a),children:s})},y=e=>{let{variant:s="default",children:a,className:l=""}=e;return(0,t.jsx)("div",{className:"border rounded-lg p-4 ".concat({default:"bg-blue-50 border-blue-200 text-blue-800",destructive:"bg-red-50 border-red-200 text-red-800"}[s]," ").concat(l),children:a})},w=e=>{let{children:s,className:a=""}=e;return(0,t.jsx)("div",{className:"text-sm ".concat(a),children:s})},f=e=>{let{value:s,className:a=""}=e;return(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden ".concat(a),children:(0,t.jsx)("div",{className:"bg-blue-600 h-full transition-all duration-300 ease-in-out",style:{width:"".concat(Math.min(100,Math.max(0,s)),"%")}})})},_=l.createContext(void 0),k=e=>{let{defaultValue:s,children:a,className:r=""}=e,[n,i]=l.useState(s);return(0,t.jsx)(_.Provider,{value:{activeTab:n,setActiveTab:i},children:(0,t.jsx)("div",{className:r,children:a})})},S=e=>{let{children:s,className:a=""}=e;return(0,t.jsx)("div",{className:"inline-flex bg-gray-100 rounded-lg p-1 ".concat(a),children:s})},A=e=>{let{value:s,children:a,className:r=""}=e,n=l.useContext(_);if(!n)throw Error("TabsTrigger must be used within Tabs");let{activeTab:i,setActiveTab:d}=n,c=i===s;return(0,t.jsx)("button",{onClick:()=>d(s),className:"px-4 py-2 text-sm font-medium rounded-md transition-colors ".concat(c?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"," ").concat(r),children:a})},C=e=>{let{value:s,children:a,className:r=""}=e,n=l.useContext(_);if(!n)throw Error("TabsContent must be used within Tabs");let{activeTab:i}=n;return i!==s?null:(0,t.jsx)("div",{className:r,children:a})};var P=a(1524);let E=e=>{let{trainingCompleted:s,cellCount:a,isLoading:l,onRefresh:r}=e;return(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"Training Results"}),(0,t.jsx)(g,{variant:s?"default":"secondary",children:s?"Complete":"In Progress"})]}),(0,t.jsx)("p",{className:"text-gray-600 mt-1",children:s?"Successfully trained on ".concat(a.toLocaleString()," cells"):"Training incomplete - some features may be unavailable"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(j,{variant:"outline",onClick:r,size:"sm",disabled:l,children:(0,t.jsx)(c.A,{className:"h-4 w-4 ".concat(l?"animate-spin":"")})}),!s&&(0,t.jsx)(n(),{href:"/training/monitor",children:(0,t.jsxs)(j,{variant:"outline",size:"sm",children:[(0,t.jsx)(P.A,{className:"mr-2 h-4 w-4"}),"Monitor"]})}),(0,t.jsx)(n(),{href:"/",children:(0,t.jsxs)(j,{variant:"outline",children:[(0,t.jsx)(o.A,{className:"mr-2 h-4 w-4"}),"Home"]})})]})]})},D=e=>{let{trainingState:s,dataSummary:a}=e,l=s.error_message?"error":s.is_running?"running":s.completed_at?"completed":"incomplete",r=Math.round(s.current_epoch/s.total_epochs*100);return(0,t.jsxs)(u,{children:[(0,t.jsxs)(p,{children:[(0,t.jsxs)(b,{className:"flex items-center justify-between",children:["Training Summary",(0,t.jsx)(g,{variant:"completed"===l?"default":"running"===l||"error"===l?"destructive":"secondary",children:"completed"===l?"✅ Completed":"running"===l?"\uD83C\uDFC3‍♂️ Running":"error"===l?"❌ Error":"⏸️ Incomplete"})]}),(0,t.jsx)(N,{children:"Training session details and final metrics"})]}),(0,t.jsxs)(v,{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{children:"Progress"}),(0,t.jsxs)("span",{children:[s.current_epoch," / ",s.total_epochs," epochs (",r,"%)"]})]}),(0,t.jsx)(f,{value:r})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-lg font-bold text-blue-600",children:a.shape.n_obs.toLocaleString()}),(0,t.jsx)("div",{className:"text-gray-600",children:"Cells"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-lg font-bold text-green-600",children:a.shape.n_vars.toLocaleString()}),(0,t.jsx)("div",{className:"text-gray-600",children:"Genes"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-lg font-bold text-purple-600",children:((e,s)=>{if(!e)return"Unknown";let a=new Date(e),t=(s?new Date(s):new Date).getTime()-a.getTime(),l=Math.floor(t/6e4),r=Math.floor(t%6e4/1e3);if(l>60){let e=Math.floor(l/60);return"".concat(e,"h ").concat(l%60,"m")}return l>0?"".concat(l,"m ").concat(r,"s"):"".concat(r,"s")})(s.started_at,s.completed_at)}),(0,t.jsx)("div",{className:"text-gray-600",children:"Duration"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-lg font-bold text-orange-600",children:s.history.length}),(0,t.jsx)("div",{className:"text-gray-600",children:"Data Points"})]})]}),s.latest_metrics&&(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h4",{className:"font-medium",children:"Final Performance Metrics"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,t.jsxs)("div",{className:"bg-gray-50 p-3 rounded",children:[(0,t.jsx)("div",{className:"font-medium",children:"Loss"}),(0,t.jsx)("div",{className:"text-lg text-red-600",children:s.latest_metrics.loss.toFixed(4)})]}),(0,t.jsxs)("div",{className:"bg-gray-50 p-3 rounded",children:[(0,t.jsx)("div",{className:"font-medium",children:"ARI"}),(0,t.jsx)("div",{className:"text-lg text-green-600",children:s.latest_metrics.ari.toFixed(3)})]}),(0,t.jsxs)("div",{className:"bg-gray-50 p-3 rounded",children:[(0,t.jsx)("div",{className:"font-medium",children:"NMI"}),(0,t.jsx)("div",{className:"text-lg text-blue-600",children:s.latest_metrics.nmi.toFixed(3)})]}),(0,t.jsxs)("div",{className:"bg-gray-50 p-3 rounded",children:[(0,t.jsx)("div",{className:"font-medium",children:"ASW"}),(0,t.jsx)("div",{className:"text-lg text-purple-600",children:s.latest_metrics.asw.toFixed(3)})]})]})]}),s.error_message&&(0,t.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded p-3",children:[(0,t.jsx)("div",{className:"font-medium text-red-800",children:"Training Error:"}),(0,t.jsx)("div",{className:"text-red-600 text-sm",children:s.error_message})]}),(0,t.jsxs)("div",{className:"text-xs text-gray-500 space-y-1",children:[(0,t.jsxs)("div",{children:["Started: ",s.started_at?new Date(s.started_at).toLocaleString():"Unknown"]}),s.completed_at&&(0,t.jsxs)("div",{children:["Completed: ",new Date(s.completed_at).toLocaleString()]})]})]})]})},F=(0,i.A)("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);var M=a(6991),I=a(5216),T=a(8425),L=a(7734),z=a(3697),R=a(7033),H=a(813),G=a(6119);let V=e=>{let{history:s}=e,a=s.map(e=>({epoch:e.epoch,loss:e.loss,ari:e.ari,nmi:e.nmi,asw:e.asw}));return(0,t.jsxs)(u,{children:[(0,t.jsxs)(p,{children:[(0,t.jsxs)(b,{className:"flex items-center gap-2",children:[(0,t.jsx)(F,{className:"h-5 w-5"}),"Training Progress"]}),(0,t.jsxs)(N,{children:[a.length," epochs tracked"]})]}),(0,t.jsx)(v,{children:a.length>0?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:"h-80",children:(0,t.jsx)(M.u,{width:"100%",height:"100%",children:(0,t.jsxs)(I.b,{data:a,children:[(0,t.jsx)(T.d,{strokeDasharray:"3 3",opacity:.2}),(0,t.jsx)(L.W,{dataKey:"epoch",label:{value:"Epoch",position:"insideBottom",offset:-5}}),(0,t.jsx)(z.h,{yAxisId:"left",orientation:"left",domain:["auto","auto"]}),(0,t.jsx)(z.h,{yAxisId:"right",orientation:"right",domain:[0,1]}),(0,t.jsx)(R.m,{formatter:e=>e.toFixed(4),contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"6px"}}),(0,t.jsx)(H.s,{}),(0,t.jsx)(G.N,{yAxisId:"left",type:"monotone",dataKey:"loss",stroke:"#dc2626",strokeWidth:2,name:"Loss",dot:!1}),(0,t.jsx)(G.N,{yAxisId:"right",type:"monotone",dataKey:"ari",stroke:"#16a34a",strokeWidth:2,name:"ARI",dot:!1}),(0,t.jsx)(G.N,{yAxisId:"right",type:"monotone",dataKey:"nmi",stroke:"#2563eb",strokeWidth:2,name:"NMI",dot:!1}),(0,t.jsx)(G.N,{yAxisId:"right",type:"monotone",dataKey:"asw",stroke:"#7c3aed",strokeWidth:2,name:"ASW",dot:!1})]})})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-sm font-medium mb-3 text-gray-700",children:"Last 10 Epochs"}),(0,t.jsx)("div",{className:"overflow-x-auto rounded-lg border",children:(0,t.jsxs)("table",{className:"w-full text-sm",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"p-3 text-left font-medium",children:"Epoch"}),(0,t.jsx)("th",{className:"p-3 text-left font-medium",children:"Loss"}),(0,t.jsx)("th",{className:"p-3 text-left font-medium",children:"ARI"}),(0,t.jsx)("th",{className:"p-3 text-left font-medium",children:"NMI"}),(0,t.jsx)("th",{className:"p-3 text-left font-medium",children:"ASW"})]})}),(0,t.jsx)("tbody",{className:"divide-y",children:s.slice(-10).reverse().map(e=>(0,t.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,t.jsx)("td",{className:"p-3 font-medium",children:e.epoch}),(0,t.jsx)("td",{className:"p-3 text-red-600",children:e.loss.toFixed(4)}),(0,t.jsx)("td",{className:"p-3 text-green-600",children:e.ari.toFixed(3)}),(0,t.jsx)("td",{className:"p-3 text-blue-600",children:e.nmi.toFixed(3)}),(0,t.jsx)("td",{className:"p-3 text-purple-600",children:e.asw.toFixed(3)})]},e.epoch))})]})})]})]}):(0,t.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,t.jsx)(F,{className:"h-8 w-8 mx-auto mb-2"}),(0,t.jsx)("p",{children:"No training metrics available"})]})})]})};var W=a(2529);let q=(e,s)=>{let[a,t]=s;return e>=t?{variant:"default",children:"Excellent"}:e>=a?{variant:"secondary",children:"Good"}:{variant:"destructive",children:"Poor"}},K=e=>{let{latestMetrics:s,chartData:a}=e;return(0,t.jsxs)("div",{className:"space-y-4",children:[s&&(0,t.jsxs)(u,{children:[(0,t.jsxs)(p,{children:[(0,t.jsx)(b,{children:"Performance Assessment"}),(0,t.jsx)(N,{children:"Quality metrics from final epoch"})]}),(0,t.jsx)(v,{children:(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h4",{className:"font-medium text-sm",children:"Clustering Quality"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[(0,t.jsxs)("span",{className:"text-sm",children:["ARI: ",s.ari.toFixed(3)]}),(0,t.jsx)(g,(0,x._)({},q(s.ari,[.4,.7])))]}),(0,t.jsxs)("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[(0,t.jsxs)("span",{className:"text-sm",children:["NMI: ",s.nmi.toFixed(3)]}),(0,t.jsx)(g,(0,x._)({},q(s.nmi,[.4,.7])))]})]})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h4",{className:"font-medium text-sm",children:"Embedding Quality"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[(0,t.jsxs)("span",{className:"text-sm",children:["ASW: ",s.asw.toFixed(3)]}),(0,t.jsx)(g,(0,x._)({},q(s.asw,[.2,.5])))]}),(0,t.jsxs)("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[(0,t.jsxs)("span",{className:"text-sm",children:["Final Loss: ",s.loss.toFixed(4)]}),(0,t.jsx)(g,{variant:"secondary",children:a.length>5&&a[a.length-1].loss<.9*a[a.length-6].loss?"Converged":"Stable"})]})]})]})]})})]}),(0,t.jsxs)(u,{children:[(0,t.jsx)(p,{children:(0,t.jsx)(b,{children:"Recommendations"})}),(0,t.jsxs)(v,{className:"space-y-3",children:[s&&(0,t.jsxs)(t.Fragment,{children:[s.ari>.7&&s.nmi>.7&&(0,t.jsx)(y,{className:"bg-green-50 border-green-200",children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(W.A,{className:"h-5 w-5 text-green-600 mt-0.5"}),(0,t.jsxs)(w,{className:"text-green-800",children:[(0,t.jsx)("strong",{children:"Excellent results!"})," Your model has learned high-quality cell embeddings suitable for downstream analysis."]})]})}),s.ari<.4&&(0,t.jsx)(y,{className:"bg-yellow-50 border-yellow-200",children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(d,{className:"h-5 w-5 text-yellow-600 mt-0.5"}),(0,t.jsxs)(w,{className:"text-yellow-800",children:[(0,t.jsx)("strong",{children:"Low clustering accuracy."})," Consider training longer or adjusting hyperparameters (beta, tc, latent_dim)."]})]})}),s.asw<.2&&s.ari>=.4&&(0,t.jsx)(y,{className:"bg-yellow-50 border-yellow-200",children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(d,{className:"h-5 w-5 text-yellow-600 mt-0.5"}),(0,t.jsxs)(w,{className:"text-yellow-800",children:[(0,t.jsx)("strong",{children:"Clusters need better separation."})," Try increasing beta or adjusting the latent dimension."]})]})})]}),(0,t.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[(0,t.jsx)("h5",{className:"font-medium mb-2 text-blue-900",children:"Next Steps"}),(0,t.jsxs)("ul",{className:"space-y-1 text-sm text-blue-800",children:[(0,t.jsx)("li",{children:"• Download embeddings for visualization and analysis"}),(0,t.jsx)("li",{children:"• Use latent embeddings for clustering and trajectory inference"}),(0,t.jsx)("li",{children:"• Validate clusters with marker gene expression"}),(0,t.jsx)("li",{children:"• Export results for collaborative research"})]})]})]})]})]})};var B=a(6132),U=a(9867),Z=a(9397);let O=(0,i.A)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]),Q=(0,i.A)("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),Y=e=>{let{availableEmbeddings:s,isGeneratingEmbeddings:a,downloadProgress:l,downloadStatus:r,onDownload:n,onDownloadAll:i,onGenerate:d,trainingCompleted:o}=e,x=s.find(e=>"interpretable"===e.embedding_type),m=s.find(e=>"latent"===e.embedding_type),h=e=>{switch(e){case"complete":return(0,t.jsx)(g,{variant:"default",className:"bg-green-600",children:"✅ Downloaded"});case"error":return(0,t.jsx)(g,{variant:"destructive",children:"❌ Error"});case"downloading":return(0,t.jsx)(g,{variant:"secondary",children:"⏳ Downloading..."});default:return null}},_=Object.values(r).some(e=>"downloading"===e);return o?(0,t.jsxs)(u,{children:[(0,t.jsxs)(p,{children:[(0,t.jsxs)(b,{className:"flex items-center space-x-2",children:[(0,t.jsx)(U.A,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:"Download Results"})]}),(0,t.jsx)(N,{children:"Download trained embeddings and model outputs"})]}),(0,t.jsxs)(v,{className:"space-y-6",children:[0===s.length&&(0,t.jsx)("div",{className:"text-center py-6",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"text-gray-500",children:[(0,t.jsx)(Z.A,{className:"h-8 w-8 mx-auto mb-2"}),(0,t.jsx)("p",{children:"Embeddings need to be generated first"})]}),(0,t.jsxs)(j,{onClick:d,disabled:a||_,children:[(0,t.jsx)(c.A,{className:"mr-2 h-4 w-4 ".concat(a?"animate-spin":"")}),a?"Generating...":"Generate Embeddings"]})]})}),s.length>0&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h4",{className:"font-medium",children:"Available Downloads"}),(0,t.jsxs)(j,{variant:"outline",size:"sm",onClick:i,disabled:_,className:"flex items-center space-x-2",children:[(0,t.jsx)(O,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Download All (ZIP)"}),r.all&&(e=>{switch(e){case"complete":return(0,t.jsx)(W.A,{className:"h-4 w-4 text-green-600"});case"error":return(0,t.jsx)(B.A,{className:"h-4 w-4 text-red-600"});case"downloading":return(0,t.jsx)(c.A,{className:"h-4 w-4 animate-spin text-blue-600"});default:return null}})(r.all)]})]}),"downloading"===r.all&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(f,{value:l.all||0}),(0,t.jsxs)("p",{className:"text-xs text-center text-gray-600",children:["Preparing ZIP file... ",Math.round(l.all||0),"%"]})]}),x&&(0,t.jsx)(u,{className:"border-green-200 bg-green-50",children:(0,t.jsx)(v,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,t.jsx)(Q,{className:"h-5 w-5 text-green-600"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h5",{className:"font-medium",children:"Interpretable Embedding"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"2D embedding for visualization and interpretation"}),x.extracted_at&&(0,t.jsxs)("p",{className:"text-xs text-green-600",children:["Generated: ",new Date(x.extracted_at).toLocaleString()]}),x.shape&&(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:["Shape: ",x.shape.n_obs," cells \xd7 ",x.shape.n_vars||2," dimensions"]})]})]}),(0,t.jsxs)("div",{className:"flex flex-col items-end space-y-2",children:[(0,t.jsx)(g,{variant:"outline",children:"CSV Format"}),"downloading"===r.interpretable?(0,t.jsxs)("div",{className:"w-32 space-y-1",children:[(0,t.jsx)(f,{value:l.interpretable||0}),(0,t.jsxs)("p",{className:"text-xs text-center",children:[Math.round(l.interpretable||0),"%"]})]}):(0,t.jsxs)(t.Fragment,{children:[h(r.interpretable||"idle"),"complete"!==r.interpretable&&(0,t.jsxs)(j,{size:"sm",onClick:()=>n("interpretable"),disabled:_,className:"flex items-center space-x-1",children:[(0,t.jsx)(U.A,{className:"h-3 w-3"}),(0,t.jsx)("span",{children:"Download"})]})]})]})]})})}),m&&(0,t.jsx)(u,{className:"border-blue-200 bg-blue-50",children:(0,t.jsx)(v,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,t.jsx)(Z.A,{className:"h-5 w-5 text-blue-600"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h5",{className:"font-medium",children:"Latent Embedding"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"High-dimensional latent space representation"}),m.extracted_at&&(0,t.jsxs)("p",{className:"text-xs text-blue-600",children:["Generated: ",new Date(m.extracted_at).toLocaleString()]}),m.shape&&(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:["Shape: ",m.shape.n_obs," cells \xd7 ",m.shape.n_vars," dimensions"]})]})]}),(0,t.jsxs)("div",{className:"flex flex-col items-end space-y-2",children:[(0,t.jsx)(g,{variant:"outline",children:"CSV Format"}),"downloading"===r.latent?(0,t.jsxs)("div",{className:"w-32 space-y-1",children:[(0,t.jsx)(f,{value:l.latent||0}),(0,t.jsxs)("p",{className:"text-xs text-center",children:[Math.round(l.latent||0),"%"]})]}):(0,t.jsxs)(t.Fragment,{children:[h(r.latent||"idle"),"complete"!==r.latent&&(0,t.jsxs)(j,{size:"sm",onClick:()=>n("latent"),disabled:_,className:"flex items-center space-x-1",children:[(0,t.jsx)(U.A,{className:"h-3 w-3"}),(0,t.jsx)("span",{children:"Download"})]})]})]})]})})}),(0,t.jsxs)("div",{className:"text-center pt-4 border-t",children:[(0,t.jsxs)(j,{variant:"outline",onClick:d,disabled:a||_,size:"sm",children:[(0,t.jsx)(c.A,{className:"mr-2 h-4 w-4 ".concat(a?"animate-spin":"")}),a?"Regenerating...":"Regenerate Embeddings"]}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"This will overwrite existing embeddings"})]})]}),(0,t.jsxs)("div",{className:"bg-gray-50 p-4 rounded",children:[(0,t.jsx)("h5",{className:"font-medium mb-2",children:"\uD83D\uDCCB File Format Information"}),(0,t.jsxs)("ul",{className:"text-sm text-gray-600 space-y-1",children:[(0,t.jsxs)("li",{children:["• ",(0,t.jsx)("strong",{children:"CSV files"})," with cell identifiers as row names"]}),(0,t.jsxs)("li",{children:["• ",(0,t.jsx)("strong",{children:"Interpretable embedding:"})," 2 columns (UMAP coordinates)"]}),(0,t.jsxs)("li",{children:["• ",(0,t.jsx)("strong",{children:"Latent embedding:"})," N columns (latent dimensions)"]}),(0,t.jsxs)("li",{children:["• ",(0,t.jsx)("strong",{children:"ZIP package:"})," All results + training history"]}),(0,t.jsxs)("li",{children:["• Compatible with ",(0,t.jsx)("strong",{children:"Python, R, and Excel"})]})]})]})]})]}):(0,t.jsxs)(u,{children:[(0,t.jsxs)(p,{children:[(0,t.jsx)(b,{children:"Download Results"}),(0,t.jsx)(N,{children:"Training must be completed first"})]}),(0,t.jsx)(v,{children:(0,t.jsx)(y,{children:(0,t.jsx)(w,{children:"Complete the training process to download embeddings and results."})})})]})};var J=a(1894);let X=()=>{let{isLoading:e,error:s,trainingCompleted:a,trainingState:r,dataSummary:i,availableEmbeddings:h,isGeneratingEmbeddings:u,downloadProgress:p,downloadStatus:b,downloadEmbedding:N,downloadAllResults:v,generateEmbeddings:f,refresh:_,clearError:P}=(()=>{let[e,s]=(0,l.useState)({isLoading:!0,error:null,trainingCompleted:!1,trainingState:null,dataSummary:null,availableEmbeddings:[],isGeneratingEmbeddings:!1,downloadProgress:{},downloadStatus:{}}),a=(0,l.useCallback)(async()=>{try{s(e=>(0,m._)((0,x._)({},e),{isLoading:!0,error:null}));let[e,a]=await Promise.all([J.FH.getTrainingProgress(),J.FH.getDataSummary()]),t=await J.mo.isTrainingComplete(),l=[];t&&(l=await J.mo.getAllEmbeddings()),s(s=>(0,m._)((0,x._)({},s),{isLoading:!1,trainingCompleted:t,trainingState:e,dataSummary:a,availableEmbeddings:l}))}catch(e){s(s=>(0,m._)((0,x._)({},s),{isLoading:!1,error:e instanceof Error?e.message:"Failed to fetch results"}))}},[]),t=(0,l.useCallback)(async e=>{try{s(s=>(0,m._)((0,x._)({},s),{downloadStatus:(0,m._)((0,x._)({},s.downloadStatus),{[e]:"downloading"}),downloadProgress:(0,m._)((0,x._)({},s.downloadProgress),{[e]:0})}));let a=await J.FH.downloadEmbedding(e,a=>{s(s=>(0,m._)((0,x._)({},s),{downloadProgress:(0,m._)((0,x._)({},s.downloadProgress),{[e]:a})}))});await J.mo.downloadFile(a,"".concat(e,"_embedding.csv"),()=>{s(s=>(0,m._)((0,x._)({},s),{downloadStatus:(0,m._)((0,x._)({},s.downloadStatus),{[e]:"complete"}),downloadProgress:(0,m._)((0,x._)({},s.downloadProgress),{[e]:100})})),setTimeout(()=>{s(s=>(0,m._)((0,x._)({},s),{downloadStatus:(0,m._)((0,x._)({},s.downloadStatus),{[e]:"idle"}),downloadProgress:(0,m._)((0,x._)({},s.downloadProgress),{[e]:0})}))},3e3)})}catch(a){s(s=>(0,m._)((0,x._)({},s),{downloadStatus:(0,m._)((0,x._)({},s.downloadStatus),{[e]:"error"}),downloadProgress:(0,m._)((0,x._)({},s.downloadProgress),{[e]:0}),error:a instanceof Error?a.message:"Download failed"}))}},[]),r=(0,l.useCallback)(async()=>{try{s(e=>(0,m._)((0,x._)({},e),{isGeneratingEmbeddings:!0,error:null})),await J.FH.extractEmbeddings(),await a()}catch(e){s(s=>(0,m._)((0,x._)({},s),{error:e instanceof Error?e.message:"Failed to generate embeddings"}))}finally{s(e=>(0,m._)((0,x._)({},e),{isGeneratingEmbeddings:!1}))}},[a]),n=(0,l.useCallback)(async()=>{try{s(e=>(0,m._)((0,x._)({},e),{downloadStatus:(0,m._)((0,x._)({},e.downloadStatus),{all:"downloading"}),downloadProgress:(0,m._)((0,x._)({},e.downloadProgress),{all:0})}));let e=await J.FH.downloadAllResults(e=>{s(s=>(0,m._)((0,x._)({},s),{downloadProgress:(0,m._)((0,x._)({},s.downloadProgress),{all:e})}))});await J.mo.downloadFile(e,"training_results.zip",()=>{s(e=>(0,m._)((0,x._)({},e),{downloadStatus:(0,m._)((0,x._)({},e.downloadStatus),{all:"complete"}),downloadProgress:(0,m._)((0,x._)({},e.downloadProgress),{all:100})})),setTimeout(()=>{s(e=>(0,m._)((0,x._)({},e),{downloadStatus:(0,m._)((0,x._)({},e.downloadStatus),{all:"idle"}),downloadProgress:(0,m._)((0,x._)({},e.downloadProgress),{all:0})}))},3e3)})}catch(e){s(s=>(0,m._)((0,x._)({},s),{downloadStatus:(0,m._)((0,x._)({},s.downloadStatus),{all:"error"}),downloadProgress:(0,m._)((0,x._)({},s.downloadProgress),{all:0}),error:e instanceof Error?e.message:"Download failed"}))}},[]);return(0,l.useEffect)(()=>{a()},[a]),(0,m._)((0,x._)({},e),{downloadEmbedding:t,generateEmbeddings:r,downloadAllResults:n,refresh:a,clearError:()=>s(e=>(0,m._)((0,x._)({},e),{error:null}))})})();if(e)return(0,t.jsx)("div",{className:"container mx-auto py-8 px-4 max-w-6xl",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),(0,t.jsx)("p",{children:"Loading results..."})]})});if(s&&!r)return(0,t.jsxs)("div",{className:"container mx-auto py-8 px-4 max-w-4xl",children:[(0,t.jsx)(y,{variant:"destructive",className:"mb-4",children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(d,{className:"h-5 w-5 mt-0.5"}),(0,t.jsx)(w,{children:s})]})}),(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsxs)(j,{onClick:_,children:[(0,t.jsx)(c.A,{className:"mr-2 h-4 w-4"}),"Retry"]}),(0,t.jsx)(n(),{href:"/",children:(0,t.jsx)(j,{variant:"outline",children:"Back to Home"})})]})]});if(!r||!i)return(0,t.jsxs)("div",{className:"container mx-auto py-8 px-4 max-w-4xl",children:[(0,t.jsx)(y,{children:(0,t.jsx)(w,{children:"No training data found. Please train a model first."})}),(0,t.jsxs)("div",{className:"mt-4 flex gap-4",children:[(0,t.jsx)(n(),{href:"/training/configure",children:(0,t.jsx)(j,{children:"Start Training"})}),(0,t.jsx)(n(),{href:"/",children:(0,t.jsxs)(j,{variant:"outline",children:[(0,t.jsx)(o.A,{className:"mr-2 h-4 w-4"}),"Back to Home"]})})]})]});let F=r.history.map(e=>({epoch:e.epoch,loss:e.loss,ari:e.ari,nmi:e.nmi,asw:e.asw}));return(0,t.jsxs)("div",{className:"container mx-auto py-8 px-4 max-w-7xl",children:[(0,t.jsx)(E,{trainingCompleted:a,cellCount:i.shape.n_obs,isLoading:e,onRefresh:_}),s&&(0,t.jsx)(y,{variant:"destructive",className:"mb-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(d,{className:"h-5 w-5 mt-0.5"}),(0,t.jsx)(w,{children:s})]}),(0,t.jsx)(j,{variant:"outline",size:"sm",onClick:P,children:"Dismiss"})]})}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(D,{trainingState:r,dataSummary:i}),(0,t.jsxs)(k,{defaultValue:"downloads",className:"space-y-4",children:[(0,t.jsxs)(S,{className:"grid w-full grid-cols-3",children:[(0,t.jsx)(A,{value:"downloads",children:(0,t.jsxs)("span",{className:"flex items-center gap-2",children:["Downloads",h.length>0&&(0,t.jsx)(g,{variant:"secondary",className:"ml-2",children:h.length})]})}),(0,t.jsx)(A,{value:"metrics",children:"Training Metrics"}),(0,t.jsx)(A,{value:"analysis",children:"Analysis"})]}),(0,t.jsx)(C,{value:"downloads",children:(0,t.jsx)(Y,{availableEmbeddings:h,isGeneratingEmbeddings:u,downloadProgress:p,downloadStatus:b,onDownload:N,onDownloadAll:v,onGenerate:f,trainingCompleted:a})}),(0,t.jsx)(C,{value:"metrics",children:(0,t.jsx)(V,{history:r.history})}),(0,t.jsx)(C,{value:"analysis",children:(0,t.jsx)(K,{latestMetrics:r.latest_metrics,chartData:F})})]})]})]})};function $(){return(0,t.jsx)(X,{})}},5409:(e,s,a)=>{Promise.resolve().then(a.bind(a,1780))}},e=>{e.O(0,[223,697,255,358],()=>e(e.s=5409)),_N_E=e.O()}]);